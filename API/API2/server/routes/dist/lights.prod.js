"use strict";var express=require("express"),router=express.Router(),MongoClient=require("mongodb").MongoClient,ObjectID=require("mongodb").ObjectID,assert=require("assert");router.get("/",function(e,o,t){o.render("lights",{title:"Lights configuration"})}),router.post("/request-udp",function(t,e,o){console.clear();var r=t.body.value.toString(),n=t.body.port,l=t.body.host,s=require("dgram"),i=new Buffer.from(r);s.createSocket("udp4").send(i,0,i.length,n,l,function(e,o){if(e)throw e;console.table([{label:t.body.label,"Driver address":l,"Driver port":n,"Driver value":r}])}),e.send("OK")}),router.post("/delete",function(e,o,t){var r=e.body.id;e.app.get("db")().collection("lights").deleteOne({_id:ObjectID(r)}),o.send("OK")}),router.post("/update",function(e,o,t){var r={label:e.body.label,value:e.body.value,host:e.body.host,port:e.body.port},n=e.body.id;e.app.get("db")().collection("lights").updateOne({_id:ObjectID(n)},{$set:r}),o.send("OK")}),router.post("/insert",function(e,o,t){var r={label:e.body.label,value:e.body.value,host:e.body.host,port:e.body.port};e.app.get("db")().collection("lights").insertOne(r,function(e,o){if(e)return console.log(e);console.log("saved to database")}),o.send("OK")}),router.get("/all",function(e,o,t){console.clear(),o.setHeader("Content-Type","application/json");var r=e.app.get("db")().collection("lights").find(),n=[];r.forEach(function(e,o){assert.equal(null,o),n.push(e)},function(){o.end(JSON.stringify(n)),console.table(n)})}),module.exports=router;